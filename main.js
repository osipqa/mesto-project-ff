(()=>{"use strict";var e={baseUrl:"https://nomoreparties.co/v1/wff-cohort-2",headers:{authorization:"637888a1-9ced-4570-b92f-3c1ad708077b","Content-Type":"application/json"}};function t(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST";return fetch("".concat(e.baseUrl).concat(t),{method:r,headers:e.headers,body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return Promise.reject("Error: ".concat(e.status))}))}var n=document.querySelector("#card-template").content.querySelector(".places__item");function r(e,t,r,o,u){var a=n.cloneNode(!0),i=a.querySelector(".card__delete-button"),l=a.querySelector(".card__image"),s=a.querySelector(".card__title"),d=a.querySelector(".card__like-button"),p=a.querySelector(".card__like-count");return l.src=e.link,s.alt=e.name,s.textContent=e.name,p.textContent=e.likes.length,l.addEventListener("click",(function(){return r(e)})),d.addEventListener("click",(function(){return o(e,u,a)})),a.id=e._id,e.owner&&u!==e.owner._id?i.remove():i.addEventListener("click",(function(){t(e)})),c(e,u)?d.classList.add("card__like-button_is-active"):d.classList.remove("card__like-button_is-active"),a}function o(e,n,r){var o,u=r.querySelector(".card__like-button"),a=r.querySelector(".card__like-count");c(e,n)?(o=e,t("/cards/likes/".concat(o._id),{},"DELETE")).then((function(t){a.textContent=t.likes.length,u.classList.remove("card__like-button_is-active"),e.likes=t.likes})).catch((function(e){return console.log(e)})):function(e){return t("/cards/likes/".concat(e._id),{},"PUT")}(e).then((function(t){a.textContent=t.likes.length,u.classList.add("card__like-button_is-active"),e.likes=t.likes})).catch((function(e){return console.log(e)}))}function c(e,t){return e.likes.some((function(e){return e._id===t}))}function u(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",i)}function a(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",i)}function i(e){"Escape"===e.code&&a(document.querySelector(".popup_is-opened"))}var l=function(e){return e.some((function(e){return!e.validity.valid}))};function s(e,t,n){var r=n.inputErrorClass,o=n.errorClass,c=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(r),c.classList.remove(o),c.textContent=""}function d(e,t,n){l(e)?(t.disabled=!0,t.classList.add(n.inactiveButtonClass)):(t.disabled=!1,t.classList.remove(n.inactiveButtonClass))}function p(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);n.forEach((function(n){s(e,n,t)})),d(n,r,t)}var _=document.querySelector(".places__list"),f=document.querySelector(".profile__edit-button"),m=document.querySelector(".profile__add-button"),v=document.querySelector(".profile__image"),y=document.querySelector(".popup__avatar"),S=document.getElementById("link-avatar-input"),h=document.querySelector(".popup_delete-image"),q=h.querySelector(".popup__button"),b=y.querySelector(".popup__button"),E=document.querySelector(".popup_type_new-card"),k=document.querySelector(".popup_type_image"),C=k.querySelector(".popup__image"),L=document.querySelector(".popup__caption"),g=document.querySelector(".profile__title"),x=document.querySelector(".profile__description"),T=document.querySelector(".popup_type_edit"),A=T.querySelector(".popup__button"),P=T.querySelector(".popup__form"),j=P.querySelector(".popup__input_type_name"),B=P.querySelector(".popup__input_type_description"),D=document.querySelectorAll(".popup"),w=E.querySelector(".popup__button"),I=E.querySelector(".popup__input_type_card-name"),U=E.querySelector(".popup__input_type_url"),M={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function G(e){u(h),q.dataset.cardId=e._id}function H(e){C.alt=e.name,L.textContent=e.name,C.src=e.link,u(k)}function N(e,t){t.textContent=e?"Сохранение...":t.dataset.buttonText}D.forEach((function(e){e.addEventListener("mouseup",(function(t){var n=t.target,r=t.currentTarget;(n.classList.contains("popup__close")||n===r)&&a(e)}))})),Promise.all([("/users/me",fetch("".concat(e.baseUrl).concat("/users/me"),{method:"GET",headers:e.headers}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return Promise.reject("Error: ".concat(e.status))}))),fetch("".concat(e.baseUrl).concat("/cards"),{method:"GET",headers:e.headers}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return Promise.reject("Error: ".concat(e.status))}))]).then((function(e){var t=e[0],n=e[1].filter((function(e){return e.owner._id===t._id}));g.textContent=e[0].name,x.textContent=e[0].about,v.style="background-image: url('".concat(e[0].avatar,"')"),n.forEach((function(e){return _.append(r(e,G,H,o,t._id))}))})).catch((function(e){return Promise.reject("Error: ".concat(e.status))})),f.addEventListener("click",(function(){j.value=g.textContent,B.value=x.textContent,p(T,M),u(T)})),m.addEventListener("click",(function(){p(E,M),u(E)})),v.addEventListener("click",(function(){p(y,M),S.value="",u(y)})),E.addEventListener("submit",(function(e){var n,c;e.preventDefault(),N(!0,w),(n=I.value,c=U.value,t("/cards",{name:n,link:c})).then((function(e){_.append(r(e,G,H,o,ID))})).catch((function(e){return console.log(e)})).finally((function(){N(!1,w),a(E)})),E.querySelector(".popup__form").reset()})),P.addEventListener("submit",(function(e){e.preventDefault(),N(!0,A),g.textContent=j.value,x.textContent=B.value,function(e,n){return t("/users/me",{name:e,about:n},"PATCH")}(j.value,B.value).then((function(e){e&&e.name&&e.about&&(g.textContent=e.name,x.textContent=e.about)})).catch((function(e){return console.log(e)})).finally((function(){N(!1,A),a(T)}))})),y.addEventListener("submit",(function(e){var n;e.preventDefault(),N(!0,b),(n=S.value,t("/users/me/avatar",{avatar:n},"PATCH")).then((function(e){v.style="background-image: url('".concat(e.avatar,"')")})).catch((function(e){return console.log(e)})).finally((function(){N(!1,b),a(y)}))})),q.addEventListener("click",(function(e){e.preventDefault(),N(!0,q);var n,r=q.dataset.cardId;console.log("Card ID to delete:",r),(n=r,t("/cards/".concat(n),{},"DELETE")).then((function(){console.log("Card successfully deleted from server");var e=document.getElementById(r);e&&(e.remove(),q.dataset.cardId="",N(!1,q),a(h))})).catch((function(e){return console.log(e)}))})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);n.forEach((function(o){o.addEventListener("input",(function(){!function(e,t,n){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?s(e,t,n):function(e,t,n,r){var o=r.inputErrorClass,c=r.errorClass,u=e.querySelector(".".concat(t.id,"-error"));t.classList.add(o),u.classList.add(c),u.textContent=n}(e,t,t.validationMessage,n)}(e,o,t),d(n,r,t)}))}))}(t,e)}))}(M)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEdBQzNCRSxFQUFhNUIsVUFBVUMsSUFBSTBCLEdBQzNCQyxFQUFhbkMsWUFBY3lHLENBQzdCLENBZ0JJQyxDQUFlNUUsRUFBYUMsRUFBY0EsRUFBYTRFLGtCQUFtQnJFLEVBSTlFLENBT01zRSxDQUFROUUsRUFBYUMsRUFBY08sR0FDbkNGLEVBQWVYLEVBQVdZLEVBQVFDLEVBQ3BDLEdBQ0YsR0FDRixDQXdCSXVFLENBQWtCL0UsRUFBYVEsRUFDakMsR0FDRixDQzBHQXdFLENBQWlCeEUsRSIsInNvdXJjZXMiOlsid2VicGFjazovL21lc3RvLXByb2plY3QtZmYvLi9zcmMvY29tcG9uZW50cy9hcGkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC1mZi8uL3NyYy9jb21wb25lbnRzL2NhcmQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC1mZi8uL3NyYy9jb21wb25lbnRzL21vZGFsLmpzIiwid2VicGFjazovL21lc3RvLXByb2plY3QtZmYvLi9zcmMvY29tcG9uZW50cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL21lc3RvLXByb2plY3QtZmYvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgY29uZmlnID0ge1xyXG4gIGJhc2VVcmw6ICdodHRwczovL25vbW9yZXBhcnRpZXMuY28vdjEvd2ZmLWNvaG9ydC0yJyxcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiAnNjM3ODg4YTEtOWNlZC00NTcwLWI5MmYtM2MxYWQ3MDgwNzdiJyxcclxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRJbmZvKGRhdGEpIHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9JHtkYXRhfWAsIHtcclxuICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gIH0pXHJcbiAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXHJcbiAgLnRoZW4ocmVzID0+IHtcclxuICAgIHJldHVybiByZXM7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke2Vyci5zdGF0dXN9YCkpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDYXJkcyhkYXRhKSB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfSR7ZGF0YX1gLCB7XHJcbiAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICB9KVxyXG4gIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxyXG4gIC50aGVuKHJlcyA9PiB7XHJcbiAgICByZXR1cm4gcmVzO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtlcnIuc3RhdHVzfWApKVxyXG59XHJcblxyXG5mdW5jdGlvbiBwb3N0KHVzZXJzLCBkYXRhLCBtZXRob2QgPSBcIlBPU1RcIikge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0ke3VzZXJzfWAsIHtcclxuICAgIG1ldGhvZCxcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXHJcbiAgfSlcclxuICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSlcclxuICAudGhlbihyZXMgPT4ge1xyXG4gICAgcmV0dXJuIHJlcztcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7ZXJyLnN0YXR1c31gKSlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHRvQ2hhbmdlTmFtZXMoaW5wdXROYW1lLCBpbnB1dERlc2NyaXB0aW9uKSB7XHJcbiAgcmV0dXJuIHBvc3QoXCIvdXNlcnMvbWVcIiwgeyBuYW1lOiBpbnB1dE5hbWUsIGFib3V0OiBpbnB1dERlc2NyaXB0aW9ufSwgXCJQQVRDSFwiKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHRvQ2hhbmdlQXZhdGFyKGF2YXRhckxpbmspIHtcclxuICByZXR1cm4gcG9zdChcIi91c2Vycy9tZS9hdmF0YXJcIiwgeyBhdmF0YXI6IGF2YXRhckxpbmsgfSwgXCJQQVRDSFwiKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFkZENhcmRzKGRhdGFOYW1lLCBkYXRhTGluaykge1xyXG4gIHJldHVybiBwb3N0KFwiL2NhcmRzXCIsIHsgbmFtZTogZGF0YU5hbWUsIGxpbms6IGRhdGFMaW5rfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBkZWxldGVDYXJkcyhjYXJkSWQpIHtcclxuICByZXR1cm4gcG9zdChgL2NhcmRzLyR7Y2FyZElkfWAsIHt9LCBcIkRFTEVURVwiKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZUxpa2UoZGF0YSkge1xyXG4gIHJldHVybiBwb3N0KGAvY2FyZHMvbGlrZXMvJHtkYXRhWydfaWQnXX1gLCB7fSwgXCJERUxFVEVcIik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhZGRMaWtlKGRhdGEpIHtcclxuICByZXR1cm4gcG9zdChgL2NhcmRzL2xpa2VzLyR7ZGF0YVsnX2lkJ119YCwge30sIFwiUFVUXCIpO1xyXG59IiwiaW1wb3J0IHsgYWRkTGlrZSwgZGVsZXRlTGlrZSB9IGZyb20gXCIuL2FwaVwiO1xyXG5leHBvcnQgeyBjcmVhdGVDYXJkLCBoYW5kbGVMaWtlIH07XHJcblxyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2FyZC10ZW1wbGF0ZScpLmNvbnRlbnQucXVlcnlTZWxlY3RvcignLnBsYWNlc19faXRlbScpO1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChkYXRhLCByZW1vdmVDYXJkLCBvcGVuSW1nLCBoYW5kbGVMaWtlLCBJRCkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNsb25lTm9kZSh0cnVlKTtcclxuICBjb25zdCBjYXJkRGVsZXRlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKTtcclxuICBjb25zdCBjYXJkSW1hZ2UgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1hZ2UnKTtcclxuICBjb25zdCBjYXJkVGl0bGUgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fdGl0bGUnKTtcclxuICBjb25zdCBjYXJkTGlrZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWJ1dHRvbicpO1xyXG4gIGNvbnN0IGNhcmRMaWtlQ291bnQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb3VudCcpO1xyXG4gIGNhcmRJbWFnZS5zcmMgPSBkYXRhLmxpbms7XHJcbiAgY2FyZFRpdGxlLmFsdCA9IGRhdGEubmFtZTtcclxuICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgY2FyZExpa2VDb3VudC50ZXh0Q29udGVudCA9IGRhdGEubGlrZXMubGVuZ3RoO1xyXG4gIGNhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IG9wZW5JbWcoZGF0YSkpO1xyXG4gIGNhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gaGFuZGxlTGlrZShkYXRhLCBJRCwgY2FyZEVsZW1lbnQpKTtcclxuICBjYXJkRWxlbWVudC5pZCA9IGRhdGFbJ19pZCddO1xyXG4gIGlmIChkYXRhLm93bmVyICYmIElEICE9PSBkYXRhLm93bmVyWydfaWQnXSkge1xyXG4gICAgY2FyZERlbGV0ZUJ1dHRvbi5yZW1vdmUoKTtcclxuICB9IGVsc2Uge1xyXG4gICAgY2FyZERlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgcmVtb3ZlQ2FyZChkYXRhKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBpZiAoY2hlY2soZGF0YSwgSUQpKSB7XHJcbiAgICBjYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmUnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlJyk7XHJcbiAgfVxyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTGlrZShjYXJkLCBJRCwgY2FyZEVsZW1lbnQpIHtcclxuICBjb25zdCBidXR0b25MaWtlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJyk7XHJcbiAgY29uc3QgYnV0dG9uQ291bnQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb3VudCcpXHJcbiAgaWYgKGNoZWNrKGNhcmQsIElEKSkge1xyXG4gICAgZGVsZXRlTGlrZShjYXJkKVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgYnV0dG9uQ291bnQudGV4dENvbnRlbnQgPSByZXMubGlrZXMubGVuZ3RoO1xyXG4gICAgICAgIGJ1dHRvbkxpa2UuY2xhc3NMaXN0LnJlbW92ZSgnY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlJyk7XHJcbiAgICAgICAgY2FyZC5saWtlcyA9IHJlcy5saWtlcztcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICB9IGVsc2Uge1xyXG4gICAgYWRkTGlrZShjYXJkKVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgYnV0dG9uQ291bnQudGV4dENvbnRlbnQgPSByZXMubGlrZXMubGVuZ3RoO1xyXG4gICAgICAgIGJ1dHRvbkxpa2UuY2xhc3NMaXN0LmFkZCgnY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlJyk7XHJcbiAgICAgICAgY2FyZC5saWtlcyA9IHJlcy5saWtlcztcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY2hlY2soZGF0YSwgSUQpIHtcclxuICByZXR1cm4gZGF0YS5saWtlcy5zb21lKChpKSA9PiBpWydfaWQnXSA9PT0gSUQpO1xyXG59IiwiZXhwb3J0IHsgb3Blbk1vZGFsLCBjbG9zZU1vZGFsIH07XHJcblxyXG5mdW5jdGlvbiBvcGVuTW9kYWwocG9wdXApIHtcclxuICBwb3B1cC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9pcy1vcGVuZWQnKTtcclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgY2xvc2VFc2MpOyAvLyBJZiBkb24ndCByZW1vdmUgdGhlIGV2ZW50bGlzdGVuZXIgZnJvbSBjbG9zZU1vZGFsLCBhbiBlcnJvciB3aWxsIG9jY3VyLlxyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsKHBvcHVwKSB7IC8vIFdpdGhvdXQgJ3NldFRpbWVvdXQnLCBpdCBiZWNhbWUgcmVhbGx5IHNhZCBoZXJlLiA6Y1xyXG4gIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX2lzLW9wZW5lZCcpO1xyXG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBjbG9zZUVzYyk7IC8vIFwiVGhpcyBwaWVjZSBvZiBjb2RlIGZpeGVzIHRoYXQuXCJcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VFc2MoZXZ0KSB7XHJcbiAgZXZ0LmNvZGUgPT09ICdFc2NhcGUnICYmIGNsb3NlTW9kYWwoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX2lzLW9wZW5lZCcpKTtcclxufSIsImNvbnN0IGNoZWNrVmFsaWQgPSAoaW5wdXRMaXN0KSA9PiBpbnB1dExpc3Quc29tZSgoaW5wdXQpID0+ICFpbnB1dC52YWxpZGl0eS52YWxpZCk7XHJcblxyXG5mdW5jdGlvbiBzaG93SW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UsIHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvckNsYXNzIH0pIHtcclxuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoaW5wdXRFcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChlcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvckNsYXNzIH0pIHtcclxuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5wdXRFcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShlcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcclxufVxyXG5cclxuZnVuY3Rpb24gaXNWYWxpZChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKSB7XHJcbiAgaWYgKGlucHV0RWxlbWVudC52YWxpZGl0eS5wYXR0ZXJuTWlzbWF0Y2gpIHtcclxuICAgIGlucHV0RWxlbWVudC5zZXRDdXN0b21WYWxpZGl0eShpbnB1dEVsZW1lbnQuZGF0YXNldC5lcnJvck1lc3NhZ2UpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBpbnB1dEVsZW1lbnQuc2V0Q3VzdG9tVmFsaWRpdHkoJycpO1xyXG4gIH1cclxuICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlLCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZykge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh2YWxpZGF0aW9uQ29uZmlnLmlucHV0U2VsZWN0b3IpKTtcclxuICBjb25zdCBidXR0b24gPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHZhbGlkYXRpb25Db25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgaXNWYWxpZChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICAgICAgZGlzYWJsZWRCdXR0b24oaW5wdXRMaXN0LCBidXR0b24sIHZhbGlkYXRpb25Db25maWcpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRpc2FibGVkQnV0dG9uKGlucHV0LCBidXR0b24sIHZhbGlkYXRpb25Db25maWcpIHtcclxuICBpZiAoY2hlY2tWYWxpZChpbnB1dCkpIHtcclxuICAgIGJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICBidXR0b24uY2xhc3NMaXN0LmFkZCh2YWxpZGF0aW9uQ29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBidXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHZhbGlkYXRpb25Db25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJWYWxpZGF0aW9uKGZvcm1FbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKSB7XHJcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25Db25maWcuaW5wdXRTZWxlY3RvcikpO1xyXG4gIGNvbnN0IGJ1dHRvbiA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodmFsaWRhdGlvbkNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXQsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIH0pXHJcbiAgZGlzYWJsZWRCdXR0b24oaW5wdXRMaXN0LCBidXR0b24sIHZhbGlkYXRpb25Db25maWcpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKSB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodmFsaWRhdGlvbkNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIH0pO1xyXG59IiwiaW1wb3J0ICcuL3N0eWxlcy9pbmRleC5jc3MnO1xyXG5pbXBvcnQgeyBjcmVhdGVDYXJkLCBoYW5kbGVMaWtlIH0gZnJvbSAnLi9jb21wb25lbnRzL2NhcmQuanMnO1xyXG5pbXBvcnQgeyBvcGVuTW9kYWwsIGNsb3NlTW9kYWwgfSBmcm9tICcuL2NvbXBvbmVudHMvbW9kYWwuanMnO1xyXG5pbXBvcnQgeyBlbmFibGVWYWxpZGF0aW9uLCBjbGVhclZhbGlkYXRpb24gfSBmcm9tICcuL2NvbXBvbmVudHMvdmFsaWRhdGlvbi5qcyc7XHJcbmltcG9ydCB7IGdldEluZm8sIGdldENhcmRzLCBkZWxldGVDYXJkcywgdG9DaGFuZ2VBdmF0YXIsIHRvQ2hhbmdlTmFtZXMsIGFkZENhcmRzfSBmcm9tICcuL2NvbXBvbmVudHMvYXBpLmpzJztcclxuXHJcbi8vIHZhcmlhYmxlIG5hbWVzXHJcbmNvbnN0IGNhcmRDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2VzX19saXN0Jyk7XHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnV0dG9uJyk7XHJcbmNvbnN0IHByb2ZpbGVCdXR0b25BZGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xyXG5jb25zdCBwcm9maWxlSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9faW1hZ2UnKTtcclxuY29uc3QgYXZhdGFyUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2F2YXRhcicpO1xyXG5jb25zdCBpbnB1dExpbmtBdmF0YXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGluay1hdmF0YXItaW5wdXQnKTtcclxuY29uc3QgcG9wdXBEZWxldGVDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX2RlbGV0ZS1pbWFnZScpO1xyXG5jb25zdCBwb3B1cERlbGV0ZUNhcmRCdXR0b24gPSBwb3B1cERlbGV0ZUNhcmQucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKTtcclxuY29uc3QgcG9wdXBCdXR0b24gPSBhdmF0YXJQb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J1dHRvbicpO1xyXG5jb25zdCBuZXdDYXJkUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9uZXctY2FyZCcpO1xyXG5jb25zdCBpbWFnZU9wZW5Qb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2ltYWdlJyk7XHJcbmNvbnN0IGltYWdlUG9wdXBJbWFnZSA9IGltYWdlT3BlblBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcclxuY29uc3QgaW1hZ2VQb3B1cENhcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2NhcHRpb24nKVxyXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX190aXRsZScpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZGVzY3JpcHRpb24nKTtcclxuY29uc3QgcG9wdXBQcm9maWxlRWRpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2VkaXQnKTtcclxuY29uc3QgcG9wdXBQcm9maWxlQnV0dG9uID0gcG9wdXBQcm9maWxlRWRpdC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J1dHRvbicpXHJcbmNvbnN0IGZvcm1Qcm9maWxlRWRpdCA9IHBvcHVwUHJvZmlsZUVkaXQucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJyk7XHJcbmNvbnN0IGlucHV0TmFtZSA9IGZvcm1Qcm9maWxlRWRpdC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfbmFtZScpO1xyXG5jb25zdCBpbnB1dERlc2NyaXB0aW9uID0gZm9ybVByb2ZpbGVFZGl0LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9kZXNjcmlwdGlvbicpO1xyXG5jb25zdCBhbGxQb3B1cHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXAnKTtcclxuY29uc3QgY2FyZEJ1dHRvbiA9IG5ld0NhcmRQb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J1dHRvbicpXHJcbmNvbnN0IGlucHV0UGxhY2VOYW1lRm9ybUFkZE5ld0NhcmQgPSBuZXdDYXJkUG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX2NhcmQtbmFtZScpO1xyXG5jb25zdCBpbnB1dFBsYWNlTGlua0Zvcm1BZGROZXdDYXJkID0gbmV3Q2FyZFBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV91cmwnKTtcclxuY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLFxyXG4gIGlucHV0U2VsZWN0b3I6ICcucG9wdXBfX2lucHV0JyxcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5wb3B1cF9fYnV0dG9uJyxcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAncG9wdXBfX2J1dHRvbl9kaXNhYmxlZCcsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0X3R5cGVfZXJyb3InLFxyXG4gIGVycm9yQ2xhc3M6ICdwb3B1cF9fZXJyb3JfdmlzaWJsZSdcclxufVxyXG5cclxuYWxsUG9wdXBzLmZvckVhY2goKG91dCkgPT4ge1xyXG4gIG91dC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKHt0YXJnZXQsIGN1cnJlbnRUYXJnZXR9KSA9PiB7IFxyXG4gICAgY29uc3QgaXNUYXJnZXRDbG9zZUJ1dHRvbiA9IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX19jbG9zZScpO1xyXG4gICAgY29uc3QgaXNUYXJnZXRPdmVybGF5ID0gdGFyZ2V0ID09PSBjdXJyZW50VGFyZ2V0O1xyXG4gICAgaWYgKGlzVGFyZ2V0Q2xvc2VCdXR0b24gfHwgaXNUYXJnZXRPdmVybGF5KSBjbG9zZU1vZGFsKG91dCk7XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuUHJvbWlzZS5hbGwoW2dldEluZm8oXCIvdXNlcnMvbWVcIiksIGdldENhcmRzKFwiL2NhcmRzXCIpXSlcclxuICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgY29uc3QgY3VycmVudFVzZXIgPSBkYXRhWzBdO1xyXG4gICAgY29uc3QgdXNlckNhcmRzID0gZGF0YVsxXS5maWx0ZXIoY2FyZCA9PiBjYXJkLm93bmVyLl9pZCA9PT0gY3VycmVudFVzZXIuX2lkKTtcclxuICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gZGF0YVswXS5uYW1lO1xyXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZGF0YVswXS5hYm91dDtcclxuICAgIHByb2ZpbGVJbWFnZS5zdHlsZSA9IGBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJyR7ZGF0YVswXS5hdmF0YXJ9JylgXHJcbiAgICB1c2VyQ2FyZHMuZm9yRWFjaChjYXJkID0+IGNhcmRDb250YWluZXIuYXBwZW5kKGNyZWF0ZUNhcmQoY2FyZCwgcmVtb3ZlQ2FyZCwgb3BlbkltZywgaGFuZGxlTGlrZSwgY3VycmVudFVzZXIuX2lkKSkpXHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke2Vyci5zdGF0dXN9YCkpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoZXZ0KSB7IC8vIGZ1bmN0aW9uIHRoYXQgYWxsb3dzIGNoYW5naW5nIHRoZSBwcm9maWxlTmFtZSBhbmQgcHJvZmlsZURlc2NyaXB0aW9uIFxyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIHNhdmVJbmZvKHRydWUsIHBvcHVwUHJvZmlsZUJ1dHRvbik7XHJcbiAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBpbnB1dE5hbWUudmFsdWU7XHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gaW5wdXREZXNjcmlwdGlvbi52YWx1ZTtcclxuICB0b0NoYW5nZU5hbWVzKGlucHV0TmFtZS52YWx1ZSwgaW5wdXREZXNjcmlwdGlvbi52YWx1ZSlcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICBpZiAocmVzICYmIHJlcy5uYW1lICYmIHJlcy5hYm91dCkge1xyXG4gICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHJlcy5uYW1lO1xyXG4gICAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSByZXMuYWJvdXQ7XHJcbiAgICB9XHJcbiAgfSlcclxuICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpXHJcbiAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgc2F2ZUluZm8oZmFsc2UsIHBvcHVwUHJvZmlsZUJ1dHRvbik7XHJcbiAgICBjbG9zZU1vZGFsKHBvcHVwUHJvZmlsZUVkaXQpO1xyXG4gIH0pXHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJTdWJtaXQoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgc2F2ZUluZm8odHJ1ZSwgcG9wdXBCdXR0b24pO1xyXG4gIHRvQ2hhbmdlQXZhdGFyKGlucHV0TGlua0F2YXRhci52YWx1ZSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgcHJvZmlsZUltYWdlLnN0eWxlID0gYGJhY2tncm91bmQtaW1hZ2U6IHVybCgnJHtyZXMuYXZhdGFyfScpYFxyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4geyBcclxuICAgICAgc2F2ZUluZm8oZmFsc2UsIHBvcHVwQnV0dG9uKTtcclxuICAgICAgY2xvc2VNb2RhbChhdmF0YXJQb3B1cCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ2FyZFN1Ym1pdChldnQpIHsgLy8gZnVuY3Rpb24gdGhhdCBhZGRzIGEgbmV3IGNhcmQgdG8gdGhlIHBhZ2VcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBzYXZlSW5mbyh0cnVlLCBjYXJkQnV0dG9uKTtcclxuICBhZGRDYXJkcyhpbnB1dFBsYWNlTmFtZUZvcm1BZGROZXdDYXJkLnZhbHVlLCBpbnB1dFBsYWNlTGlua0Zvcm1BZGROZXdDYXJkLnZhbHVlKVxyXG4gICAgLnRoZW4oKGNhcmQpID0+IHtcclxuICAgICAgY2FyZENvbnRhaW5lci5hcHBlbmQoY3JlYXRlQ2FyZChjYXJkLCByZW1vdmVDYXJkLCBvcGVuSW1nLCBoYW5kbGVMaWtlLCBJRCkpXHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBzYXZlSW5mbyhmYWxzZSwgY2FyZEJ1dHRvbik7XHJcbiAgICAgIGNsb3NlTW9kYWwobmV3Q2FyZFBvcHVwKTtcclxuICAgIH0pXHJcbiAgbmV3Q2FyZFBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpLnJlc2V0KCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmQoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgc2F2ZUluZm8odHJ1ZSwgcG9wdXBEZWxldGVDYXJkQnV0dG9uKTtcclxuICBjb25zdCBjYXJkSUQgPSBwb3B1cERlbGV0ZUNhcmRCdXR0b24uZGF0YXNldC5jYXJkSWQ7XHJcbiAgY29uc29sZS5sb2coXCJDYXJkIElEIHRvIGRlbGV0ZTpcIiwgY2FyZElEKTtcclxuICBkZWxldGVDYXJkcyhjYXJkSUQpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdDYXJkIHN1Y2Nlc3NmdWxseSBkZWxldGVkIGZyb20gc2VydmVyJyk7XHJcbiAgICAgIGNvbnN0IGRlbGV0ZUNhcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjYXJkSUQpO1xyXG4gICAgICBpZiAoZGVsZXRlQ2FyZCkge1xyXG4gICAgICAgIGRlbGV0ZUNhcmQucmVtb3ZlKCk7XHJcbiAgICAgICAgcG9wdXBEZWxldGVDYXJkQnV0dG9uLmRhdGFzZXQuY2FyZElkID0gJyc7XHJcbiAgICAgICAgc2F2ZUluZm8oZmFsc2UsIHBvcHVwRGVsZXRlQ2FyZEJ1dHRvbik7XHJcbiAgICAgICAgY2xvc2VNb2RhbChwb3B1cERlbGV0ZUNhcmQpO1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVtb3ZlQ2FyZChjYXJkKSB7XHJcbiAgb3Blbk1vZGFsKHBvcHVwRGVsZXRlQ2FyZCk7XHJcbiAgcG9wdXBEZWxldGVDYXJkQnV0dG9uLmRhdGFzZXQuY2FyZElkID0gY2FyZFsnX2lkJ107XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5JbWcoZGF0YSkge1xyXG4gIGltYWdlUG9wdXBJbWFnZS5hbHQgPSBkYXRhLm5hbWU7XHJcbiAgaW1hZ2VQb3B1cENhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgaW1hZ2VQb3B1cEltYWdlLnNyYyA9IGRhdGEubGluaztcclxuICBvcGVuTW9kYWwoaW1hZ2VPcGVuUG9wdXApO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gc2F2ZUluZm8obG9hZCwgYnV0dG9uVGV4dCkge1xyXG4gIGlmIChsb2FkKSB7XHJcbiAgICBidXR0b25UZXh0LnRleHRDb250ZW50ID0gJ9Ch0L7RhdGA0LDQvdC10L3QuNC1Li4uJ1xyXG4gIH0gZWxzZSB7XHJcbiAgICBidXR0b25UZXh0LnRleHRDb250ZW50ID0gYnV0dG9uVGV4dC5kYXRhc2V0LmJ1dHRvblRleHQ7XHJcbiAgfVxyXG59XHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBpbnB1dE5hbWUudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcclxuICBpbnB1dERlc2NyaXB0aW9uLnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xyXG4gIGNsZWFyVmFsaWRhdGlvbihwb3B1cFByb2ZpbGVFZGl0LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICBvcGVuTW9kYWwocG9wdXBQcm9maWxlRWRpdCk7XHJcbn0pO1xyXG5cclxucHJvZmlsZUJ1dHRvbkFkZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBjbGVhclZhbGlkYXRpb24obmV3Q2FyZFBvcHVwLCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICBvcGVuTW9kYWwobmV3Q2FyZFBvcHVwKTtcclxufSk7XHJcblxyXG5wcm9maWxlSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgY2xlYXJWYWxpZGF0aW9uKGF2YXRhclBvcHVwLCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICBpbnB1dExpbmtBdmF0YXIudmFsdWUgPSAnJztcclxuICBvcGVuTW9kYWwoYXZhdGFyUG9wdXApO1xyXG59KVxyXG5cclxubmV3Q2FyZFBvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGhhbmRsZUNhcmRTdWJtaXQpO1xyXG5mb3JtUHJvZmlsZUVkaXQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQpO1xyXG5hdmF0YXJQb3B1cC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBoYW5kbGVBdmF0YXJTdWJtaXQpO1xyXG5wb3B1cERlbGV0ZUNhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVEZWxldGVDYXJkKTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvbkNvbmZpZyk7Il0sIm5hbWVzIjpbImNvbmZpZyIsImJhc2VVcmwiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInBvc3QiLCJ1c2VycyIsImRhdGEiLCJtZXRob2QiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJmZXRjaCIsImNvbmNhdCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwidGhlbiIsInJlcyIsImpzb24iLCJjYXRjaCIsImVyciIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJjYXJkVGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY3JlYXRlQ2FyZCIsInJlbW92ZUNhcmQiLCJvcGVuSW1nIiwiaGFuZGxlTGlrZSIsIklEIiwiY2FyZEVsZW1lbnQiLCJjbG9uZU5vZGUiLCJjYXJkRGVsZXRlQnV0dG9uIiwiY2FyZEltYWdlIiwiY2FyZFRpdGxlIiwiY2FyZExpa2VCdXR0b24iLCJjYXJkTGlrZUNvdW50Iiwic3JjIiwibGluayIsImFsdCIsIm5hbWUiLCJ0ZXh0Q29udGVudCIsImxpa2VzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImlkIiwib3duZXIiLCJyZW1vdmUiLCJjaGVjayIsImNsYXNzTGlzdCIsImFkZCIsImNhcmQiLCJidXR0b25MaWtlIiwiYnV0dG9uQ291bnQiLCJjb25zb2xlIiwibG9nIiwiYWRkTGlrZSIsInNvbWUiLCJpIiwib3Blbk1vZGFsIiwicG9wdXAiLCJjbG9zZUVzYyIsImNsb3NlTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0IiwiY29kZSIsImNoZWNrVmFsaWQiLCJpbnB1dExpc3QiLCJpbnB1dCIsInZhbGlkaXR5IiwidmFsaWQiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiX3JlZjIiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiZXJyb3JFbGVtZW50IiwiZGlzYWJsZWRCdXR0b24iLCJidXR0b24iLCJ2YWxpZGF0aW9uQ29uZmlnIiwiZGlzYWJsZWQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiY2xlYXJWYWxpZGF0aW9uIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImZvckVhY2giLCJjYXJkQ29udGFpbmVyIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlQnV0dG9uQWRkIiwicHJvZmlsZUltYWdlIiwiYXZhdGFyUG9wdXAiLCJpbnB1dExpbmtBdmF0YXIiLCJnZXRFbGVtZW50QnlJZCIsInBvcHVwRGVsZXRlQ2FyZCIsInBvcHVwRGVsZXRlQ2FyZEJ1dHRvbiIsInBvcHVwQnV0dG9uIiwibmV3Q2FyZFBvcHVwIiwiaW1hZ2VPcGVuUG9wdXAiLCJpbWFnZVBvcHVwSW1hZ2UiLCJpbWFnZVBvcHVwQ2FwdGlvbiIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicG9wdXBQcm9maWxlRWRpdCIsInBvcHVwUHJvZmlsZUJ1dHRvbiIsImZvcm1Qcm9maWxlRWRpdCIsImlucHV0TmFtZSIsImlucHV0RGVzY3JpcHRpb24iLCJhbGxQb3B1cHMiLCJjYXJkQnV0dG9uIiwiaW5wdXRQbGFjZU5hbWVGb3JtQWRkTmV3Q2FyZCIsImlucHV0UGxhY2VMaW5rRm9ybUFkZE5ld0NhcmQiLCJmb3JtU2VsZWN0b3IiLCJkYXRhc2V0IiwiY2FyZElkIiwic2F2ZUluZm8iLCJsb2FkIiwiYnV0dG9uVGV4dCIsIm91dCIsIl9yZWYiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiY29udGFpbnMiLCJhbGwiLCJjdXJyZW50VXNlciIsInVzZXJDYXJkcyIsImZpbHRlciIsIl9pZCIsImFib3V0Iiwic3R5bGUiLCJhdmF0YXIiLCJhcHBlbmQiLCJ2YWx1ZSIsImRhdGFOYW1lIiwiZGF0YUxpbmsiLCJwcmV2ZW50RGVmYXVsdCIsImZpbmFsbHkiLCJyZXNldCIsInRvQ2hhbmdlTmFtZXMiLCJhdmF0YXJMaW5rIiwiY2FyZElEIiwiZGVsZXRlQ2FyZCIsInBhdHRlcm5NaXNtYXRjaCIsInNldEN1c3RvbVZhbGlkaXR5IiwiZXJyb3JNZXNzYWdlIiwic2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImlzVmFsaWQiLCJzZXRFdmVudExpc3RlbmVycyIsImVuYWJsZVZhbGlkYXRpb24iXSwic291cmNlUm9vdCI6IiJ9