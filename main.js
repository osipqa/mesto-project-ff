(()=>{"use strict";var e={baseUrl:"https://nomoreparties.co/v1/wff-cohort-2",headers:{authorization:"637888a1-9ced-4570-b92f-3c1ad708077b","Content-Type":"application/json"}};function t(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST";return fetch("".concat(e.baseUrl).concat(t),{method:r,headers:e.headers,body:JSON.stringify(n)}).then((function(e){return e.json()})).catch((function(e){return Promise.reject("Error: ".concat(e.status))}))}var n=document.querySelector("#card-template").content.querySelector(".places__item");function r(e,t,r,o,c){var u=n.cloneNode(!0),i=u.querySelector(".card__delete-button"),l=u.querySelector(".card__image"),s=u.querySelector(".card__title"),d=u.querySelector(".card__like-button"),p=u.querySelector(".card__like-count");return l.src=e.link,s.alt=e.name,s.textContent=e.name,p.textContent=e.likes.length,l.addEventListener("click",(function(){return r(e)})),d.addEventListener("click",(function(){return o(e,c,u)})),u.id=e._id,e.owner&&c!==e.owner._id?i.remove():i.addEventListener("click",(function(){t(e)})),a(e,c)?d.classList.add("card__like-button_is-active"):d.classList.remove("card__like-button_is-active"),u}function o(e,n,r){var o,i=r.querySelector(".card__like-button"),l=r.querySelector(".card__like-count");a(e,n)?(o=e,t("/cards/likes/".concat(o._id),{},"DELETE")).then((function(t){c(t,i,l),e.likes=t.likes})).catch(u):function(e){return t("/cards/likes/".concat(e._id),{},"PUT")}(e).then((function(t){c(t,i,l),e.likes=t.likes})).catch(u)}function c(e,t,n){t.classList.toggle("card__like-button_is-active"),n.textContent=e.likes.length}function u(e){console.log("Error message: ".concat(e))}function a(e,t){return e.likes.some((function(e){return e._id===t}))}function i(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",s)}function l(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",s)}function s(e){"Escape"===e.code&&l(document.querySelector(".popup_is-opened"))}var d=function(e){return e.some((function(e){return!e.validity.valid}))};function p(e,t,n){var r=n.inputErrorClass,o=n.errorClass,c=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(r),c.classList.remove(o),c.textContent=""}function _(e,t,n){d(e)?(t.disabled=!0,t.classList.add(n.inactiveButtonClass)):(t.disabled=!1,t.classList.remove(n.inactiveButtonClass))}function f(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);n.forEach((function(n){p(e,n,t)})),_(n,r,t)}var m=document.querySelector(".places__list"),v=document.querySelector(".profile__edit-button"),y=document.querySelector(".profile__add-button"),S=document.querySelector(".profile__image"),h=document.querySelector(".popup__avatar"),q=document.getElementById("link-avatar-input"),b=document.querySelector(".popup_delete-image"),E=b.querySelector(".popup__button"),k=h.querySelector(".popup__button"),C=document.querySelector(".popup_type_new-card"),L=document.querySelector(".popup_type_image"),g=L.querySelector(".popup__image"),x=document.querySelector(".popup__caption"),T=document.querySelector(".profile__title"),A=document.querySelector(".profile__description"),P=document.querySelector(".popup_type_edit"),j=P.querySelector(".popup__button"),B=P.querySelector(".popup__form"),w=B.querySelector(".popup__input_type_name"),D=B.querySelector(".popup__input_type_description"),I=document.querySelectorAll(".popup"),U=C.querySelector(".popup__button"),M=C.querySelector(".popup__input_type_card-name"),G=C.querySelector(".popup__input_type_url"),H={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function N(e){i(b),E.dataset.cardId=e._id}function O(e){g.alt=e.name,x.textContent=e.name,g.src=e.link,i(L)}function V(e,t){t.textContent=e?"Сохранение...":t.dataset.buttonText}I.forEach((function(e){e.addEventListener("mouseup",(function(t){var n=t.target,r=t.currentTarget;(n.classList.contains("popup__close")||n===r)&&l(e)}))})),Promise.all([("/users/me",fetch("".concat(e.baseUrl).concat("/users/me"),{method:"GET",headers:e.headers}).then((function(e){return e.json()})).catch((function(e){return Promise.reject("Error: ".concat(e.status))}))),fetch("".concat(e.baseUrl).concat("/cards"),{method:"GET",headers:e.headers}).then((function(e){return e.json()})).catch((function(e){return Promise.reject("Error: ".concat(e.status))}))]).then((function(e){var t=e[0],n=e[1].filter((function(e){return e.owner._id===t._id}));T.textContent=e[0].name,A.textContent=e[0].about,S.style="background-image: url('".concat(e[0].avatar,"')"),n.forEach((function(e){return m.append(r(e,N,O,o,t._id))}))})).catch((function(e){return Promise.reject("Error: ".concat(e.status))})),v.addEventListener("click",(function(){w.value=T.textContent,D.value=A.textContent,f(P,H),i(P)})),y.addEventListener("click",(function(){f(C,H),i(C)})),S.addEventListener("click",(function(){q.value="",f(h,H),i(h)})),C.addEventListener("submit",(function(e){var n,c;e.preventDefault(),V(!0,U),(n=M.value,c=G.value,t("/cards",{name:n,link:c})).then((function(e){m.append(r(e,N,O,o,ID))})).catch((function(e){return console.log(e)})).finally((function(){V(!1,U),l(C)})),C.querySelector(".popup__form").reset()})),B.addEventListener("submit",(function(e){e.preventDefault(),V(!0,j),T.textContent=w.value,A.textContent=D.value,function(e,n){return t("/users/me",{name:e,about:n},"PATCH")}(w.value,D.value).then((function(e){e&&e.name&&e.about&&(T.textContent=e.name,A.textContent=e.about)})).catch((function(e){return console.log(e)})).finally((function(){V(!1,j),l(P)}))})),h.addEventListener("submit",(function(e){var n;e.preventDefault(),V(!0,k),(n=q.value,t("/users/me/avatar",{avatar:n},"PATCH")).then((function(e){S.style="background-image: url('".concat(e.avatar,"')")})).catch((function(e){return console.log(e)})).finally((function(){V(!1,k),l(h)}))})),E.addEventListener("click",(function(e){e.preventDefault(),V(!0,E);var n,r=E.dataset.cardId;(n=r,t("/cards/".concat(n),{},"DELETE")).then((function(){var e=document.getElementById(r);e&&(e.remove(),E.dataset.cardId="",V(!1,E),l(b))})).catch((function(e){return console.log(e)}))})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);n.forEach((function(o){o.addEventListener("input",(function(){!function(e,t,n){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?p(e,t,n):function(e,t,n,r){var o=r.inputErrorClass,c=r.errorClass,u=e.querySelector(".".concat(t.id,"-error"));t.classList.add(o),u.classList.add(c),u.textContent=n}(e,t,t.validationMessage,n)}(e,o,t),_(n,r,t)}))}))}(t,e)}))}(H)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R0FDbkNGLEVBQWVYLEVBQVdZLEVBQVFDLEVBQ3BDLEdBQ0YsR0FDRixDQXdCSXVFLENBQWtCL0UsRUFBYVEsRUFDakMsR0FDRixDQ3dHQXdFLENBQWlCeEUsRSIsInNvdXJjZXMiOlsid2VicGFjazovL21lc3RvLXByb2plY3QtZmYvLi9zcmMvY29tcG9uZW50cy9hcGkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC1mZi8uL3NyYy9jb21wb25lbnRzL2NhcmQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC1mZi8uL3NyYy9jb21wb25lbnRzL21vZGFsLmpzIiwid2VicGFjazovL21lc3RvLXByb2plY3QtZmYvLi9zcmMvY29tcG9uZW50cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL21lc3RvLXByb2plY3QtZmYvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgY29uZmlnID0ge1xyXG4gIGJhc2VVcmw6ICdodHRwczovL25vbW9yZXBhcnRpZXMuY28vdjEvd2ZmLWNvaG9ydC0yJyxcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiAnNjM3ODg4YTEtOWNlZC00NTcwLWI5MmYtM2MxYWQ3MDgwNzdiJyxcclxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRJbmZvKGRhdGEpIHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9JHtkYXRhfWAsIHtcclxuICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gIH0pXHJcbiAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXHJcbiAgLmNhdGNoKChlcnIpID0+IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtlcnIuc3RhdHVzfWApKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2FyZHMoZGF0YSkge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0ke2RhdGF9YCwge1xyXG4gICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgfSlcclxuICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSlcclxuICAuY2F0Y2goKGVycikgPT4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke2Vyci5zdGF0dXN9YCkpXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBvc3QodXNlcnMsIGRhdGEsIG1ldGhvZCA9IFwiUE9TVFwiKSB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfSR7dXNlcnN9YCwge1xyXG4gICAgbWV0aG9kLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSxcclxuICB9KVxyXG4gIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxyXG4gIC5jYXRjaCgoZXJyKSA9PiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7ZXJyLnN0YXR1c31gKSlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHRvQ2hhbmdlTmFtZXMoaW5wdXROYW1lLCBpbnB1dERlc2NyaXB0aW9uKSB7XHJcbiAgcmV0dXJuIHBvc3QoXCIvdXNlcnMvbWVcIiwgeyBuYW1lOiBpbnB1dE5hbWUsIGFib3V0OiBpbnB1dERlc2NyaXB0aW9ufSwgXCJQQVRDSFwiKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHRvQ2hhbmdlQXZhdGFyKGF2YXRhckxpbmspIHtcclxuICByZXR1cm4gcG9zdChcIi91c2Vycy9tZS9hdmF0YXJcIiwgeyBhdmF0YXI6IGF2YXRhckxpbmsgfSwgXCJQQVRDSFwiKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFkZENhcmRzKGRhdGFOYW1lLCBkYXRhTGluaykge1xyXG4gIHJldHVybiBwb3N0KFwiL2NhcmRzXCIsIHsgbmFtZTogZGF0YU5hbWUsIGxpbms6IGRhdGFMaW5rfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBkZWxldGVDYXJkcyhjYXJkSWQpIHtcclxuICByZXR1cm4gcG9zdChgL2NhcmRzLyR7Y2FyZElkfWAsIHt9LCBcIkRFTEVURVwiKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZUxpa2UoZGF0YSkge1xyXG4gIHJldHVybiBwb3N0KGAvY2FyZHMvbGlrZXMvJHtkYXRhWydfaWQnXX1gLCB7fSwgXCJERUxFVEVcIik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhZGRMaWtlKGRhdGEpIHtcclxuICByZXR1cm4gcG9zdChgL2NhcmRzL2xpa2VzLyR7ZGF0YVsnX2lkJ119YCwge30sIFwiUFVUXCIpO1xyXG59IiwiaW1wb3J0IHsgYWRkTGlrZSwgZGVsZXRlTGlrZSB9IGZyb20gXCIuL2FwaVwiO1xyXG5leHBvcnQgeyBjcmVhdGVDYXJkLCBoYW5kbGVMaWtlIH07XHJcblxyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2FyZC10ZW1wbGF0ZScpLmNvbnRlbnQucXVlcnlTZWxlY3RvcignLnBsYWNlc19faXRlbScpO1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChkYXRhLCByZW1vdmVDYXJkLCBvcGVuSW1nLCBoYW5kbGVMaWtlLCBJRCkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNsb25lTm9kZSh0cnVlKTtcclxuICBjb25zdCBjYXJkRGVsZXRlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKTtcclxuICBjb25zdCBjYXJkSW1hZ2UgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1hZ2UnKTtcclxuICBjb25zdCBjYXJkVGl0bGUgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fdGl0bGUnKTtcclxuICBjb25zdCBjYXJkTGlrZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWJ1dHRvbicpO1xyXG4gIGNvbnN0IGNhcmRMaWtlQ291bnQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb3VudCcpO1xyXG4gIGNhcmRJbWFnZS5zcmMgPSBkYXRhLmxpbms7XHJcbiAgY2FyZFRpdGxlLmFsdCA9IGRhdGEubmFtZTtcclxuICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgY2FyZExpa2VDb3VudC50ZXh0Q29udGVudCA9IGRhdGEubGlrZXMubGVuZ3RoO1xyXG4gIGNhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IG9wZW5JbWcoZGF0YSkpO1xyXG4gIGNhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gaGFuZGxlTGlrZShkYXRhLCBJRCwgY2FyZEVsZW1lbnQpKTtcclxuICBjYXJkRWxlbWVudC5pZCA9IGRhdGFbJ19pZCddO1xyXG4gIGlmIChkYXRhLm93bmVyICYmIElEICE9PSBkYXRhLm93bmVyWydfaWQnXSkge1xyXG4gICAgY2FyZERlbGV0ZUJ1dHRvbi5yZW1vdmUoKTtcclxuICB9IGVsc2Uge1xyXG4gICAgY2FyZERlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgcmVtb3ZlQ2FyZChkYXRhKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBpZiAoY2hlY2soZGF0YSwgSUQpKSB7XHJcbiAgICBjYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmUnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlJyk7XHJcbiAgfVxyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTGlrZShjYXJkLCB1c2VySUQsIGNhcmRFbGVtZW50KSB7XHJcbiAgY29uc3QgYnV0dG9uTGlrZSA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWJ1dHRvbicpO1xyXG4gIGNvbnN0IGJ1dHRvbkNvdW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtY291bnQnKTtcclxuXHJcbiAgaWYgKGNoZWNrKGNhcmQsIHVzZXJJRCkpIHtcclxuICAgIGRlbGV0ZUxpa2UoY2FyZClcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGhhbmRsZUxpa2VTdWNjZXNzKHJlcywgYnV0dG9uTGlrZSwgYnV0dG9uQ291bnQpO1xyXG4gICAgICAgIGNhcmQubGlrZXMgPSByZXMubGlrZXM7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChoYW5kbGVMaWtlRXJyb3IpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBhZGRMaWtlKGNhcmQpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBoYW5kbGVMaWtlU3VjY2VzcyhyZXMsIGJ1dHRvbkxpa2UsIGJ1dHRvbkNvdW50KTtcclxuICAgICAgICBjYXJkLmxpa2VzID0gcmVzLmxpa2VzO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goaGFuZGxlTGlrZUVycm9yKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUxpa2VTdWNjZXNzKHJlcywgYnV0dG9uTGlrZSwgYnV0dG9uQ291bnQpIHtcclxuICBidXR0b25MaWtlLmNsYXNzTGlzdC50b2dnbGUoJ2NhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZScpO1xyXG4gIGJ1dHRvbkNvdW50LnRleHRDb250ZW50ID0gcmVzLmxpa2VzLmxlbmd0aDtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTGlrZUVycm9yKGVycikge1xyXG4gIGNvbnNvbGUubG9nKGBFcnJvciBtZXNzYWdlOiAke2Vycn1gKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2hlY2soZGF0YSwgdXNlcklEKSB7XHJcbiAgcmV0dXJuIGRhdGEubGlrZXMuc29tZSgobGlrZSkgPT4gbGlrZVsnX2lkJ10gPT09IHVzZXJJRCk7XHJcbn1cclxuIiwiZXhwb3J0IHsgb3Blbk1vZGFsLCBjbG9zZU1vZGFsIH07XHJcblxyXG5mdW5jdGlvbiBvcGVuTW9kYWwocG9wdXApIHtcclxuICBwb3B1cC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9pcy1vcGVuZWQnKTtcclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgY2xvc2VFc2MpOyAvLyBJZiBkb24ndCByZW1vdmUgdGhlIGV2ZW50bGlzdGVuZXIgZnJvbSBjbG9zZU1vZGFsLCBhbiBlcnJvciB3aWxsIG9jY3VyLlxyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsKHBvcHVwKSB7IC8vIFdpdGhvdXQgJ3NldFRpbWVvdXQnLCBpdCBiZWNhbWUgcmVhbGx5IHNhZCBoZXJlLiA6Y1xyXG4gIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX2lzLW9wZW5lZCcpO1xyXG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBjbG9zZUVzYyk7IC8vIFwiVGhpcyBwaWVjZSBvZiBjb2RlIGZpeGVzIHRoYXQuXCJcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VFc2MoZXZ0KSB7XHJcbiAgZXZ0LmNvZGUgPT09ICdFc2NhcGUnICYmIGNsb3NlTW9kYWwoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX2lzLW9wZW5lZCcpKTtcclxufSIsImNvbnN0IGNoZWNrVmFsaWQgPSAoaW5wdXRMaXN0KSA9PiBpbnB1dExpc3Quc29tZSgoaW5wdXQpID0+ICFpbnB1dC52YWxpZGl0eS52YWxpZCk7XHJcblxyXG5mdW5jdGlvbiBzaG93SW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UsIHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvckNsYXNzIH0pIHtcclxuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoaW5wdXRFcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChlcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvckNsYXNzIH0pIHtcclxuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5wdXRFcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShlcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcclxufVxyXG5cclxuZnVuY3Rpb24gaXNWYWxpZChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKSB7XHJcbiAgaWYgKGlucHV0RWxlbWVudC52YWxpZGl0eS5wYXR0ZXJuTWlzbWF0Y2gpIHtcclxuICAgIGlucHV0RWxlbWVudC5zZXRDdXN0b21WYWxpZGl0eShpbnB1dEVsZW1lbnQuZGF0YXNldC5lcnJvck1lc3NhZ2UpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBpbnB1dEVsZW1lbnQuc2V0Q3VzdG9tVmFsaWRpdHkoJycpO1xyXG4gIH1cclxuICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlLCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZykge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh2YWxpZGF0aW9uQ29uZmlnLmlucHV0U2VsZWN0b3IpKTtcclxuICBjb25zdCBidXR0b24gPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHZhbGlkYXRpb25Db25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgaXNWYWxpZChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICAgICAgZGlzYWJsZWRCdXR0b24oaW5wdXRMaXN0LCBidXR0b24sIHZhbGlkYXRpb25Db25maWcpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRpc2FibGVkQnV0dG9uKGlucHV0LCBidXR0b24sIHZhbGlkYXRpb25Db25maWcpIHtcclxuICBpZiAoY2hlY2tWYWxpZChpbnB1dCkpIHtcclxuICAgIGJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICBidXR0b24uY2xhc3NMaXN0LmFkZCh2YWxpZGF0aW9uQ29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBidXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHZhbGlkYXRpb25Db25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJWYWxpZGF0aW9uKGZvcm1FbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKSB7XHJcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25Db25maWcuaW5wdXRTZWxlY3RvcikpO1xyXG4gIGNvbnN0IGJ1dHRvbiA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodmFsaWRhdGlvbkNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXQsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIH0pXHJcbiAgZGlzYWJsZWRCdXR0b24oaW5wdXRMaXN0LCBidXR0b24sIHZhbGlkYXRpb25Db25maWcpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKSB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodmFsaWRhdGlvbkNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vKiBcclxuXHJcbtCf0YDQuNCy0LXRgiwg0YDQtdCy0YzQtdGO0YAgOilcclxuXHJcbtCvINC30L3QsNGOLCDRh9GC0L4g0LzQvtC5INC60L7QtCDQv9C70L7RhdC+0LksINC90L4g0Y8sINC/0YDQsNCy0LTQsCwg0YHRgtCw0YDQsNGO0YHRjCFcclxuXHJcbtCX0LTQtdGB0Ywg0Y8g0L/RgNC+0YHRgtC+INC/0L7Qt9C00YDQsNCy0LvRj9GOINCS0LDRgSDRgSDQvdCw0YHRgtGD0L/QsNGO0YnQuNC8INC/0YDQsNC30LTQvdC40LrQvtC8LCDRgSDQvdCw0YHRgtGD0L/QsNGO0YnQuNC8INC90L7QstGL0LwgMjAyNCDQs9C+0LTQvtC8IVxyXG7QltC10LvQsNGOINCS0LDQvCDQstGB0LXQs9C+INGB0LDQvNC+0LPQviDQvdCw0LjQu9GD0YfRiNC10LPQviwg0YfQtdCz0L4g0YLQvtC70YzQutC+INCy0L7Qt9C80L7QttC90L4gOilcclxuXHJcbtCa0YHRgtCw0YLQuCwg0LLQvtGCINCS0LDQvCDQtdC70LrQsCwg0L/QvtC70YzQt9GD0LnRgtC10YHRjC4gOlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEwMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMTAxMDFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgMTAxMDEwMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDEwMTAxMDEwMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgMTAxMDEwMTAxMDFcclxuICAgICAgICAgICAgICAgICAgICAgICAgMTAxMDEwMTAxMDEwMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwXHJcblxyXG4qLyIsImltcG9ydCAnLi9zdHlsZXMvaW5kZXguY3NzJztcclxuaW1wb3J0IHsgY3JlYXRlQ2FyZCwgaGFuZGxlTGlrZSB9IGZyb20gJy4vY29tcG9uZW50cy9jYXJkLmpzJztcclxuaW1wb3J0IHsgb3Blbk1vZGFsLCBjbG9zZU1vZGFsIH0gZnJvbSAnLi9jb21wb25lbnRzL21vZGFsLmpzJztcclxuaW1wb3J0IHsgZW5hYmxlVmFsaWRhdGlvbiwgY2xlYXJWYWxpZGF0aW9uIH0gZnJvbSAnLi9jb21wb25lbnRzL3ZhbGlkYXRpb24uanMnO1xyXG5pbXBvcnQgeyBnZXRJbmZvLCBnZXRDYXJkcywgZGVsZXRlQ2FyZHMsIHRvQ2hhbmdlQXZhdGFyLCB0b0NoYW5nZU5hbWVzLCBhZGRDYXJkc30gZnJvbSAnLi9jb21wb25lbnRzL2FwaS5qcyc7XHJcblxyXG4vLyB2YXJpYWJsZSBuYW1lc1xyXG5jb25zdCBjYXJkQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYWNlc19fbGlzdCcpO1xyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ1dHRvbicpO1xyXG5jb25zdCBwcm9maWxlQnV0dG9uQWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTtcclxuY29uc3QgcHJvZmlsZUltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlJyk7XHJcbmNvbnN0IGF2YXRhclBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19hdmF0YXInKTtcclxuY29uc3QgaW5wdXRMaW5rQXZhdGFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbmstYXZhdGFyLWlucHV0Jyk7XHJcbmNvbnN0IHBvcHVwRGVsZXRlQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9kZWxldGUtaW1hZ2UnKTtcclxuY29uc3QgcG9wdXBEZWxldGVDYXJkQnV0dG9uID0gcG9wdXBEZWxldGVDYXJkLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnV0dG9uJyk7XHJcbmNvbnN0IHBvcHVwQnV0dG9uID0gYXZhdGFyUG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKTtcclxuY29uc3QgbmV3Q2FyZFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfbmV3LWNhcmQnKTtcclxuY29uc3QgaW1hZ2VPcGVuUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9pbWFnZScpO1xyXG5jb25zdCBpbWFnZVBvcHVwSW1hZ2UgPSBpbWFnZU9wZW5Qb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XHJcbmNvbnN0IGltYWdlUG9wdXBDYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19jYXB0aW9uJylcclxuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fdGl0bGUnKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2Rlc2NyaXB0aW9uJyk7XHJcbmNvbnN0IHBvcHVwUHJvZmlsZUVkaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9lZGl0Jyk7XHJcbmNvbnN0IHBvcHVwUHJvZmlsZUJ1dHRvbiA9IHBvcHVwUHJvZmlsZUVkaXQucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKVxyXG5jb25zdCBmb3JtUHJvZmlsZUVkaXQgPSBwb3B1cFByb2ZpbGVFZGl0LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xyXG5jb25zdCBpbnB1dE5hbWUgPSBmb3JtUHJvZmlsZUVkaXQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF90eXBlX25hbWUnKTtcclxuY29uc3QgaW5wdXREZXNjcmlwdGlvbiA9IGZvcm1Qcm9maWxlRWRpdC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfZGVzY3JpcHRpb24nKTtcclxuY29uc3QgYWxsUG9wdXBzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwJyk7XHJcbmNvbnN0IGNhcmRCdXR0b24gPSBuZXdDYXJkUG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b24nKVxyXG5jb25zdCBpbnB1dFBsYWNlTmFtZUZvcm1BZGROZXdDYXJkID0gbmV3Q2FyZFBvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfdHlwZV9jYXJkLW5hbWUnKTtcclxuY29uc3QgaW5wdXRQbGFjZUxpbmtGb3JtQWRkTmV3Q2FyZCA9IG5ld0NhcmRQb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfdXJsJyk7XHJcbmNvbnN0IHZhbGlkYXRpb25Db25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiAnLnBvcHVwX19mb3JtJyxcclxuICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX2J1dHRvbicsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogJ3BvcHVwX19idXR0b25fZGlzYWJsZWQnLFxyXG4gIGlucHV0RXJyb3JDbGFzczogJ3BvcHVwX19pbnB1dF90eXBlX2Vycm9yJyxcclxuICBlcnJvckNsYXNzOiAncG9wdXBfX2Vycm9yX3Zpc2libGUnXHJcbn1cclxuXHJcbmFsbFBvcHVwcy5mb3JFYWNoKChvdXQpID0+IHtcclxuICBvdXQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsICh7dGFyZ2V0LCBjdXJyZW50VGFyZ2V0fSkgPT4geyBcclxuICAgIGNvbnN0IGlzVGFyZ2V0Q2xvc2VCdXR0b24gPSB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fY2xvc2UnKTtcclxuICAgIGNvbnN0IGlzVGFyZ2V0T3ZlcmxheSA9IHRhcmdldCA9PT0gY3VycmVudFRhcmdldDtcclxuICAgIGlmIChpc1RhcmdldENsb3NlQnV0dG9uIHx8IGlzVGFyZ2V0T3ZlcmxheSkgY2xvc2VNb2RhbChvdXQpO1xyXG4gIH0pO1xyXG59KTtcclxuXHJcblByb21pc2UuYWxsKFtnZXRJbmZvKFwiL3VzZXJzL21lXCIpLCBnZXRDYXJkcyhcIi9jYXJkc1wiKV0pXHJcbiAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgIGNvbnN0IGN1cnJlbnRVc2VyID0gZGF0YVswXTtcclxuICAgIGNvbnN0IHVzZXJDYXJkcyA9IGRhdGFbMV0uZmlsdGVyKGNhcmQgPT4gY2FyZC5vd25lci5faWQgPT09IGN1cnJlbnRVc2VyLl9pZCk7XHJcbiAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IGRhdGFbMF0ubmFtZTtcclxuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRhdGFbMF0uYWJvdXQ7XHJcbiAgICBwcm9maWxlSW1hZ2Uuc3R5bGUgPSBgYmFja2dyb3VuZC1pbWFnZTogdXJsKCcke2RhdGFbMF0uYXZhdGFyfScpYFxyXG4gICAgdXNlckNhcmRzLmZvckVhY2goY2FyZCA9PiBjYXJkQ29udGFpbmVyLmFwcGVuZChjcmVhdGVDYXJkKGNhcmQsIHJlbW92ZUNhcmQsIG9wZW5JbWcsIGhhbmRsZUxpa2UsIGN1cnJlbnRVc2VyLl9pZCkpKVxyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtlcnIuc3RhdHVzfWApKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KGV2dCkgeyAvLyBmdW5jdGlvbiB0aGF0IGFsbG93cyBjaGFuZ2luZyB0aGUgcHJvZmlsZU5hbWUgYW5kIHByb2ZpbGVEZXNjcmlwdGlvbiBcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBzYXZlSW5mbyh0cnVlLCBwb3B1cFByb2ZpbGVCdXR0b24pO1xyXG4gIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gaW5wdXROYW1lLnZhbHVlO1xyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGlucHV0RGVzY3JpcHRpb24udmFsdWU7XHJcbiAgdG9DaGFuZ2VOYW1lcyhpbnB1dE5hbWUudmFsdWUsIGlucHV0RGVzY3JpcHRpb24udmFsdWUpXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgaWYgKHJlcyAmJiByZXMubmFtZSAmJiByZXMuYWJvdXQpIHtcclxuICAgICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSByZXMubmFtZTtcclxuICAgICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gcmVzLmFib3V0O1xyXG4gICAgfVxyXG4gIH0pXHJcbiAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gIC5maW5hbGx5KCgpID0+IHtcclxuICAgIHNhdmVJbmZvKGZhbHNlLCBwb3B1cFByb2ZpbGVCdXR0b24pO1xyXG4gICAgY2xvc2VNb2RhbChwb3B1cFByb2ZpbGVFZGl0KTtcclxuICB9KVxyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIHNhdmVJbmZvKHRydWUsIHBvcHVwQnV0dG9uKTtcclxuICB0b0NoYW5nZUF2YXRhcihpbnB1dExpbmtBdmF0YXIudmFsdWUpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVJbWFnZS5zdHlsZSA9IGBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJyR7cmVzLmF2YXRhcn0nKWBcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHsgXHJcbiAgICAgIHNhdmVJbmZvKGZhbHNlLCBwb3B1cEJ1dHRvbik7XHJcbiAgICAgIGNsb3NlTW9kYWwoYXZhdGFyUG9wdXApO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRTdWJtaXQoZXZ0KSB7IC8vIGZ1bmN0aW9uIHRoYXQgYWRkcyBhIG5ldyBjYXJkIHRvIHRoZSBwYWdlXHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgc2F2ZUluZm8odHJ1ZSwgY2FyZEJ1dHRvbik7XHJcbiAgYWRkQ2FyZHMoaW5wdXRQbGFjZU5hbWVGb3JtQWRkTmV3Q2FyZC52YWx1ZSwgaW5wdXRQbGFjZUxpbmtGb3JtQWRkTmV3Q2FyZC52YWx1ZSlcclxuICAgIC50aGVuKChjYXJkKSA9PiB7XHJcbiAgICAgIGNhcmRDb250YWluZXIuYXBwZW5kKGNyZWF0ZUNhcmQoY2FyZCwgcmVtb3ZlQ2FyZCwgb3BlbkltZywgaGFuZGxlTGlrZSwgSUQpKVxyXG4gICAgfSlcclxuICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgc2F2ZUluZm8oZmFsc2UsIGNhcmRCdXR0b24pO1xyXG4gICAgICBjbG9zZU1vZGFsKG5ld0NhcmRQb3B1cCk7XHJcbiAgICB9KVxyXG4gIG5ld0NhcmRQb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKS5yZXNldCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIHNhdmVJbmZvKHRydWUsIHBvcHVwRGVsZXRlQ2FyZEJ1dHRvbik7XHJcbiAgY29uc3QgY2FyZElEID0gcG9wdXBEZWxldGVDYXJkQnV0dG9uLmRhdGFzZXQuY2FyZElkO1xyXG4gIGRlbGV0ZUNhcmRzKGNhcmRJRClcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgY29uc3QgZGVsZXRlQ2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNhcmRJRCk7XHJcbiAgICAgIGlmIChkZWxldGVDYXJkKSB7XHJcbiAgICAgICAgZGVsZXRlQ2FyZC5yZW1vdmUoKTtcclxuICAgICAgICBwb3B1cERlbGV0ZUNhcmRCdXR0b24uZGF0YXNldC5jYXJkSWQgPSAnJztcclxuICAgICAgICBzYXZlSW5mbyhmYWxzZSwgcG9wdXBEZWxldGVDYXJkQnV0dG9uKTtcclxuICAgICAgICBjbG9zZU1vZGFsKHBvcHVwRGVsZXRlQ2FyZCk7XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW1vdmVDYXJkKGNhcmQpIHtcclxuICBvcGVuTW9kYWwocG9wdXBEZWxldGVDYXJkKTtcclxuICBwb3B1cERlbGV0ZUNhcmRCdXR0b24uZGF0YXNldC5jYXJkSWQgPSBjYXJkWydfaWQnXTtcclxufVxyXG5cclxuZnVuY3Rpb24gb3BlbkltZyhkYXRhKSB7XHJcbiAgaW1hZ2VQb3B1cEltYWdlLmFsdCA9IGRhdGEubmFtZTtcclxuICBpbWFnZVBvcHVwQ2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICBpbWFnZVBvcHVwSW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xyXG4gIG9wZW5Nb2RhbChpbWFnZU9wZW5Qb3B1cCk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBzYXZlSW5mbyhsb2FkLCBidXR0b25UZXh0KSB7XHJcbiAgaWYgKGxvYWQpIHtcclxuICAgIGJ1dHRvblRleHQudGV4dENvbnRlbnQgPSAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nXHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1dHRvblRleHQudGV4dENvbnRlbnQgPSBidXR0b25UZXh0LmRhdGFzZXQuYnV0dG9uVGV4dDtcclxuICB9XHJcbn1cclxuXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gIGlucHV0TmFtZS52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gIGlucHV0RGVzY3JpcHRpb24udmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XHJcbiAgY2xlYXJWYWxpZGF0aW9uKHBvcHVwUHJvZmlsZUVkaXQsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIG9wZW5Nb2RhbChwb3B1cFByb2ZpbGVFZGl0KTtcclxufSk7XHJcblxyXG5wcm9maWxlQnV0dG9uQWRkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gIGNsZWFyVmFsaWRhdGlvbihuZXdDYXJkUG9wdXAsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIG9wZW5Nb2RhbChuZXdDYXJkUG9wdXApO1xyXG59KTtcclxuXHJcbnByb2ZpbGVJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBpbnB1dExpbmtBdmF0YXIudmFsdWUgPSAnJztcclxuICBjbGVhclZhbGlkYXRpb24oYXZhdGFyUG9wdXAsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIG9wZW5Nb2RhbChhdmF0YXJQb3B1cCk7XHJcbn0pXHJcblxyXG5uZXdDYXJkUG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgaGFuZGxlQ2FyZFN1Ym1pdCk7XHJcbmZvcm1Qcm9maWxlRWRpdC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCk7XHJcbmF2YXRhclBvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGhhbmRsZUF2YXRhclN1Ym1pdCk7XHJcbnBvcHVwRGVsZXRlQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZURlbGV0ZUNhcmQpO1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKTsiXSwibmFtZXMiOlsiY29uZmlnIiwiYmFzZVVybCIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwicG9zdCIsInVzZXJzIiwiZGF0YSIsIm1ldGhvZCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImZldGNoIiwiY29uY2F0IiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0aGVuIiwicmVzIiwianNvbiIsImNhdGNoIiwiZXJyIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImNhcmRUZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjcmVhdGVDYXJkIiwicmVtb3ZlQ2FyZCIsIm9wZW5JbWciLCJoYW5kbGVMaWtlIiwiSUQiLCJjYXJkRWxlbWVudCIsImNsb25lTm9kZSIsImNhcmREZWxldGVCdXR0b24iLCJjYXJkSW1hZ2UiLCJjYXJkVGl0bGUiLCJjYXJkTGlrZUJ1dHRvbiIsImNhcmRMaWtlQ291bnQiLCJzcmMiLCJsaW5rIiwiYWx0IiwibmFtZSIsInRleHRDb250ZW50IiwibGlrZXMiLCJhZGRFdmVudExpc3RlbmVyIiwiaWQiLCJvd25lciIsInJlbW92ZSIsImNoZWNrIiwiY2xhc3NMaXN0IiwiYWRkIiwiY2FyZCIsInVzZXJJRCIsImJ1dHRvbkxpa2UiLCJidXR0b25Db3VudCIsImhhbmRsZUxpa2VTdWNjZXNzIiwiaGFuZGxlTGlrZUVycm9yIiwiYWRkTGlrZSIsInRvZ2dsZSIsImNvbnNvbGUiLCJsb2ciLCJzb21lIiwibGlrZSIsIm9wZW5Nb2RhbCIsInBvcHVwIiwiY2xvc2VFc2MiLCJjbG9zZU1vZGFsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImNvZGUiLCJjaGVja1ZhbGlkIiwiaW5wdXRMaXN0IiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWxlbWVudCIsImlucHV0RWxlbWVudCIsIl9yZWYyIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImVycm9yRWxlbWVudCIsImRpc2FibGVkQnV0dG9uIiwiYnV0dG9uIiwidmFsaWRhdGlvbkNvbmZpZyIsImRpc2FibGVkIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImNsZWFyVmFsaWRhdGlvbiIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJmb3JFYWNoIiwiY2FyZENvbnRhaW5lciIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUJ1dHRvbkFkZCIsInByb2ZpbGVJbWFnZSIsImF2YXRhclBvcHVwIiwiaW5wdXRMaW5rQXZhdGFyIiwiZ2V0RWxlbWVudEJ5SWQiLCJwb3B1cERlbGV0ZUNhcmQiLCJwb3B1cERlbGV0ZUNhcmRCdXR0b24iLCJwb3B1cEJ1dHRvbiIsIm5ld0NhcmRQb3B1cCIsImltYWdlT3BlblBvcHVwIiwiaW1hZ2VQb3B1cEltYWdlIiwiaW1hZ2VQb3B1cENhcHRpb24iLCJwcm9maWxlTmFtZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsInBvcHVwUHJvZmlsZUVkaXQiLCJwb3B1cFByb2ZpbGVCdXR0b24iLCJmb3JtUHJvZmlsZUVkaXQiLCJpbnB1dE5hbWUiLCJpbnB1dERlc2NyaXB0aW9uIiwiYWxsUG9wdXBzIiwiY2FyZEJ1dHRvbiIsImlucHV0UGxhY2VOYW1lRm9ybUFkZE5ld0NhcmQiLCJpbnB1dFBsYWNlTGlua0Zvcm1BZGROZXdDYXJkIiwiZm9ybVNlbGVjdG9yIiwiZGF0YXNldCIsImNhcmRJZCIsInNhdmVJbmZvIiwibG9hZCIsImJ1dHRvblRleHQiLCJvdXQiLCJfcmVmIiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsImNvbnRhaW5zIiwiYWxsIiwiY3VycmVudFVzZXIiLCJ1c2VyQ2FyZHMiLCJmaWx0ZXIiLCJfaWQiLCJhYm91dCIsInN0eWxlIiwiYXZhdGFyIiwiYXBwZW5kIiwidmFsdWUiLCJkYXRhTmFtZSIsImRhdGFMaW5rIiwicHJldmVudERlZmF1bHQiLCJmaW5hbGx5IiwicmVzZXQiLCJ0b0NoYW5nZU5hbWVzIiwiYXZhdGFyTGluayIsImNhcmRJRCIsImRlbGV0ZUNhcmQiLCJwYXR0ZXJuTWlzbWF0Y2giLCJzZXRDdXN0b21WYWxpZGl0eSIsImVycm9yTWVzc2FnZSIsInNob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJpc1ZhbGlkIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJlbmFibGVWYWxpZGF0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==